TODO: Clean up this absolute mess
